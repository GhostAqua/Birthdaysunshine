<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Happy Birthday</title>
    
    <!-- Fonts: Playfair Display (Serif) & Satoshi (Sans via Fontshare CDN) -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@400;700&display=swap" rel="stylesheet">
    <link href="https://api.fontshare.com/v2/css?f[]=satoshi@400,500,700&display=swap" rel="stylesheet">

    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Libraries -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/gsap.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>

    <style>
        /* --- Global & Fonts --- */
        body {
            margin: 0;
            overflow: hidden;
            font-family: 'Satoshi', sans-serif;
            background-color: #0c0a09;
            color: #f3f4f6;
        }

        h1, h2, h3 {
            font-family: 'Playfair Display', serif;
        }

        /* --- Layer 1: Animated Aurora Gradient --- */
        .aurora-bg {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: -2;
            background: 
                radial-gradient(circle at 15% 50%, hsla(333,70%,55%,.4), transparent 50%),
                radial-gradient(circle at 85% 30%, hsla(282, 82%, 54%, .3), transparent 50%),
                radial-gradient(circle at 50% 80%, hsla(210, 89%, 60%, .3), transparent 50%),
                radial-gradient(circle at 50% 20%, hsla(35, 90%, 60%, .3), transparent 50%);
            background-size: 200% 200%;
            animation: auroraFlow 15s ease infinite alternate;
            filter: blur(40px);
        }

        @keyframes auroraFlow {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }

        /* --- Layer 2: Canvas Container --- */
        #heart-canvas {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: -1;
            pointer-events: none; /* Let clicks pass through */
        }

        /* --- Glassmorphism Card Style --- */
        .glass-card {
            background: rgba(12, 10, 9, 0.6);
            backdrop-filter: blur(16px);
            -webkit-backdrop-filter: blur(16px);
            border: 1px solid rgba(255, 255, 255, 0.1);
            box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.5);
        }

        /* --- Text Gradient --- */
        .text-gradient {
            background: linear-gradient(135deg, #fff 0%, #fbcfe8 100%);
            -webkit-background-clip: text;
            background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        /* --- Custom Button --- */
        .btn-primary {
            background: linear-gradient(90deg, #ec4899 0%, #ef4444 100%);
            box-shadow: 0 0 15px rgba(236, 72, 153, 0.5);
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }
        .btn-primary:hover {
            transform: scale(1.05) translateY(-2px);
            box-shadow: 0 0 25px rgba(236, 72, 153, 0.8);
        }
        .btn-primary:active {
            transform: scale(0.95);
        }

        /* --- Progress Bar --- */
        .progress-track {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(4px);
        }
        .progress-fill {
            background: linear-gradient(90deg, #ec4899, #ef4444);
            transition: width 1s cubic-bezier(0.4, 0, 0.2, 1);
        }

        /* --- Polaroid 3D Effect --- */
        .polaroid-container {
            perspective: 1000px;
        }
        .polaroid-card {
            transform-style: preserve-3d;
            transition: transform 0.1s ease-out; /* Smooth follow */
        }

        /* --- Utility --- */
        .hidden-step {
            display: none;
            opacity: 0;
        }
    </style>
</head>
<body class="antialiased">

    <!-- Background Layers -->
    <div class="aurora-bg"></div>
    <canvas id="heart-canvas"></canvas>

    <!-- Progress Bar -->
    <div class="fixed top-0 left-0 w-full h-2 z-50 flex justify-center pt-4">
        <div class="progress-track w-11/12 max-w-md h-1.5 rounded-full overflow-hidden">
            <div id="progress-bar" class="progress-fill h-full w-0 rounded-full"></div>
        </div>
    </div>

    <!-- Main Content Container -->
    <main class="relative z-10 w-full h-screen flex items-center justify-center p-4">
        
        <!-- STEP 1: Grand Welcome -->
        <section id="step-1" class="glass-card w-full max-w-lg rounded-3xl p-8 md:p-12 text-center transform will-change-transform">
            <div class="gsap-elem text-6xl md:text-7xl mb-6 filter drop-shadow-[0_0_15px_rgba(236,72,153,0.6)] animate-pulse">
                ‚ù§Ô∏è
            </div>
            <h1 class="gsap-elem text-4xl md:text-5xl font-bold mb-4 text-gradient leading-tight">
                Hey Beautiful,
            </h1>
            <p class="gsap-elem text-lg md:text-xl text-gray-300 mb-8 font-light leading-relaxed">
                I built a little world for you, just to bring a smile to your face on your special day.
            </p>
            <button onclick="nextStep(2)" class="gsap-elem btn-primary px-8 py-3 rounded-full text-white font-bold text-lg tracking-wide">
                can we start!
            </button>
        </section>

        <!-- STEP 2: Core Message -->
        <section id="step-2" class="hidden-step glass-card w-full max-w-lg rounded-3xl p-8 md:p-12 text-center transform will-change-transform">
            <div class="gsap-elem text-6xl md:text-7xl mb-6">
                üéâ
            </div>
            <h1 class="gsap-elem text-4xl md:text-5xl font-bold mb-4 text-gradient">
                Happy Birthday!
            </h1>
            <p class="gsap-elem text-lg md:text-xl text-gray-300 mb-8 font-light leading-relaxed">
                Another year of you making the world brighter. Your existence is a gift, and I'm so lucky to witness it.
            </p>
            <button onclick="nextStep(3)" class="gsap-elem btn-primary px-8 py-3 rounded-full text-white font-bold text-lg tracking-wide">
                There's more...
            </button>
        </section>

        <!-- STEP 3: Bento Grid (Reasons) -->
        <section id="step-3" class="hidden-step glass-card w-full max-w-2xl rounded-3xl p-6 md:p-10 text-center transform will-change-transform">
            <h2 class="gsap-elem text-3xl md:text-4xl font-bold mb-8 text-gradient">
                A Few Things I Adore About You
            </h2>
            
            <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-8 text-left">
                <!-- Card 1 -->
                <div class="gsap-elem col-span-1 md:col-span-2 bg-white/5 border border-white/10 p-5 rounded-2xl hover:bg-white/10 transition-colors">
                    <h3 class="text-xl font-bold text-pink-300 mb-2">‚ú® Your Unmatched Kindness</h3>
                    <p class="text-gray-300 text-sm md:text-base">The genuine warmth you show to everyone is something truly rare and beautiful.</p>
                </div>
                
                <!-- Card 2 -->
                <div class="gsap-elem bg-white/5 border border-white/10 p-5 rounded-2xl hover:bg-white/10 transition-colors">
                    <h3 class="text-xl font-bold text-pink-300 mb-2">üòä That Smile</h3>
                    <p class="text-gray-300 text-sm md:text-base">It's a work of art and i cant take my eyes off it</p>
                </div>
                
                <!-- Card 3 -->
                <div class="gsap-elem col-span-1 md:col-span-2 bg-white/5 border border-white/10 p-5 rounded-2xl hover:bg-white/10 transition-colors">
                    <h3 class="text-xl font-bold text-pink-300 mb-2">üåü Your Adorable Side</h3>
                    <p class="text-gray-300 text-sm md:text-base">There‚Äôs a quiet cuteness in the way you express yourself, and it stays with me.</p>
                </div>
            </div>

            <button onclick="nextStep(4)" class="gsap-elem btn-primary px-8 py-3 rounded-full text-white font-bold text-lg tracking-wide">
                For you?
            </button>
        </section>
s
        <!-- STEP 4: Shared Memory (Polaroid) -->
        <section id="step-4" class="hidden-step glass-card w-full max-w-lg rounded-3xl p-8 md:p-12 text-center transform will-change-transform">
            <h2 class="gsap-elem text-3xl md:text-4xl font-bold mb-6 text-gradient">
                For the one...
            </h2>
            
            <!-- Polaroid Wrapper -->
            <div class="gsap-elem polaroid-container flex justify-center mb-6">
                <div id="polaroid" class="polaroid-card bg-white p-3 pb-8 shadow-2xl rotate-2 hover:z-50 cursor-pointer w-64 md:w-72">
                    <div class="aspect-[4/3] w-full bg-gray-200 overflow-hidden mb-4 relative">
                        <img src="https://images.hindustantimes.com/rf/image_size_630x354/HT/p2/2017/02/22/Pictures/_9f1e46d6-f8c1-11e6-ab12-d7625b180dd1.jpeg" alt="Our Memory" class="object-cover w-full h-full">
                        <div class="absolute inset-0 bg-gradient-to-t from-black/20 to-transparent"></div>
                    </div>
                    <p class="font-handwriting text-gray-800 font-bold text-lg transform -rotate-1" style="font-family: 'Playfair Display', serif; font-style: italic;">
                        The prettiest girl ‚ú®
                    </p>
                </div>
            </div>

            <p class="gsap-elem text-lg text-gray-300 mb-8 font-light">
                Even without meeting you, our conversations feel like scenes I don‚Äôt want to skip...
            </p>
            <button onclick="nextStep(5)" class="gsap-elem btn-primary px-8 py-3 rounded-full text-white font-bold text-lg tracking-wide">
                One last thing...
            </button>
        </section>

        <!-- STEP 5: Finale -->
        <section id="step-5" class="hidden-step glass-card w-full max-w-lg rounded-3xl p-8 md:p-12 text-center transform will-change-transform">
            <div class="gsap-elem text-6xl md:text-7xl mb-6">
                üéÇ
            </div>
            <h1 class="gsap-elem text-4xl md:text-5xl font-bold mb-4 text-gradient">
                My Wish For You
            </h1>
            <p class="gsap-elem text-lg md:text-xl text-gray-300 mb-6 font-light leading-relaxed">
                May the next year bring you all the love, success, and pure happiness you so rightfully deserve.May your dreams fly higher than ever, carrying you to places your heart has always hoped for
            </p>
            
            <div id="final-message" class="hidden opacity-0 transform translate-y-4 mb-8">
                <h2 class="text-3xl md:text-4xl font-bold text-pink-400 drop-shadow-lg">
                    Happy Birthday Sunshine
                </h2>
            </div>

            <button id="celebrate-btn" onclick="celebrate()" class="gsap-elem btn-primary px-10 py-4 rounded-full text-white font-bold text-xl tracking-wide shadow-[0_0_30px_rgba(236,72,153,0.6)]">
                Celebrate!
            </button>
        </section>

    </main>

    <script>
        // --- 1. Three.js Setup (Background Hearts) ---
        const canvas = document.querySelector('#heart-canvas');
        const renderer = new THREE.WebGLRenderer({ canvas, alpha: true, antialias: true });
        renderer.setSize(window.innerWidth, window.innerHeight);
        renderer.setPixelRatio(window.devicePixelRatio);

        const scene = new THREE.Scene();
        const camera = new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 0.1, 1000);
        camera.position.z = 30;

        // Lights
        const ambientLight = new THREE.AmbientLight(0xffffff, 0.5);
        scene.add(ambientLight);
        const pointLight = new THREE.PointLight(0xffffff, 1);
        pointLight.position.set(10, 10, 10);
        scene.add(pointLight);

        // Heart Shape
        const x = 0, y = 0;
        const heartShape = new THREE.Shape();
        heartShape.moveTo( x + 5, y + 5 );
        heartShape.bezierCurveTo( x + 5, y + 5, x + 4, y, x, y );
        heartShape.bezierCurveTo( x - 6, y, x - 6, y + 7,x - 6, y + 7 );
        heartShape.bezierCurveTo( x - 6, y + 11, x - 3, y + 15.4, x + 5, y + 19 );
        heartShape.bezierCurveTo( x + 12, y + 15.4, x + 16, y + 11, x + 16, y + 7 );
        heartShape.bezierCurveTo( x + 16, y + 7, x + 16, y, x + 10, y );
        heartShape.bezierCurveTo( x + 7, y, x + 5, y + 5, x + 5, y + 5 );

        const geometry = new THREE.ShapeGeometry( heartShape );
        const material = new THREE.MeshPhongMaterial({ 
            color: 0xff3366, 
            emissive: 0x440011,
            shininess: 30, 
            flatShading: false,
            side: THREE.DoubleSide
        });

        // Create Hearts
        const hearts = [];
        const heartCount = 25;
        let finaleMode = false;

        for (let i = 0; i < heartCount; i++) {
            const mesh = new THREE.Mesh(geometry, material);
            // Randomize position
            mesh.position.x = (Math.random() - 0.5) * 60;
            mesh.position.y = (Math.random() - 0.5) * 40;
            mesh.position.z = (Math.random() - 0.5) * 20 - 10;
            
            // Randomize scale
            const scale = Math.random() * 0.15 + 0.05;
            mesh.scale.set(scale, scale, scale);
            
            // Randomize rotation
            mesh.rotation.x = Math.PI; // Flip to be upright
            mesh.rotation.z = (Math.random() - 0.5) * 0.5;

            // Store animation data
            mesh.userData = {
                speedY: Math.random() * 0.02 + 0.01,
                speedRot: (Math.random() - 0.5) * 0.01,
                wobbleOffset: Math.random() * Math.PI * 2,
                initialY: mesh.position.y
            };

            scene.add(mesh);
            hearts.push(mesh);
        }

        // Animation Loop
        function animate() {
            requestAnimationFrame(animate);

            hearts.forEach(heart => {
                if (!finaleMode) {
                    // Normal gentle float
                    heart.position.y += Math.sin(Date.now() * 0.001 + heart.userData.wobbleOffset) * 0.02;
                    heart.rotation.z += heart.userData.speedRot;
                    heart.rotation.y = Math.sin(Date.now() * 0.0005 + heart.userData.wobbleOffset) * 0.2;
                } else {
                    // Finale: Swirl out and up
                    heart.position.y += 0.2; // Fast up
                    heart.position.x += Math.sin(Date.now() * 0.002 + heart.userData.wobbleOffset) * 0.1; // Widen
                    heart.rotation.z += 0.05;
                    heart.rotation.y += 0.05;
                    
                    // Fade out (via scale since material transparency is tricky with depth write)
                    if(heart.scale.x > 0) {
                         const shrink = 0.001;
                         heart.scale.set(
                             Math.max(0, heart.scale.x - shrink),
                             Math.max(0, heart.scale.y - shrink),
                             Math.max(0, heart.scale.z - shrink)
                         );
                    }
                }
            });

            renderer.render(scene, camera);
        }
        animate();

        // Resize Handler
        window.addEventListener('resize', () => {
            camera.aspect = window.innerWidth / window.innerHeight;
            camera.updateProjectionMatrix();
            renderer.setSize(window.innerWidth, window.innerHeight);
        });


        // --- 2. Interactive Logic (GSAP & Steps) ---
        let currentStep = 1;
        const progressBar = document.getElementById('progress-bar');
        const progressSteps = { 1: '20%', 2: '40%', 3: '60%', 4: '80%', 5: '100%' };

        // Initial Animation for Step 1
        window.addEventListener('load', () => {
            progressBar.style.width = '20%';
            gsap.from("#step-1 .gsap-elem", {
                y: 30,
                opacity: 0,
                duration: 1,
                stagger: 0.2,
                ease: "power3.out"
            });
        });

        function nextStep(targetStep) {
            const currentEl = document.getElementById(`step-${currentStep}`);
            const nextEl = document.getElementById(`step-${targetStep}`);
            
            // Update Progress
            progressBar.style.width = progressSteps[targetStep];

            // Animate OUT current step
            gsap.to(currentEl, {
                opacity: 0,
                scale: 0.95,
                duration: 0.5,
                ease: "power2.in",
                onComplete: () => {
                    currentEl.classList.add('hidden-step');
                    
                    // Prepare NEXT step
                    nextEl.classList.remove('hidden-step');
                    
                    // Animate IN next step container
                    gsap.fromTo(nextEl, 
                        { opacity: 0, scale: 0.9, y: 50 },
                        { opacity: 1, scale: 1, y: 0, duration: 0.6, ease: "back.out(1.2)" }
                    );
                    
                    // Stagger internal elements
                    gsap.fromTo(`#step-${targetStep} .gsap-elem`, 
                        { opacity: 0, y: 20 },
                        { opacity: 1, y: 0, duration: 0.6, stagger: 0.1, delay: 0.2, ease: "power2.out" }
                    );

                    currentStep = targetStep;
                }
            });
        }

        // --- 3. Polaroid Tilt Effect ---
        const polaroid = document.getElementById('polaroid');
        const polaroidContainer = document.querySelector('.polaroid-container');

        polaroidContainer.addEventListener('mousemove', (e) => {
            const rect = polaroid.getBoundingClientRect();
            const x = e.clientX - rect.left; // x position within the element.
            const y = e.clientY - rect.top;  // y position within the element.
            
            const centerX = rect.width / 2;
            const centerY = rect.height / 2;
            
            const rotateX = ((y - centerY) / centerY) * -10; // Max 10deg rotation
            const rotateY = ((x - centerX) / centerX) * 10;

            polaroid.style.transform = `rotateX(${rotateX}deg) rotateY(${rotateY}deg) scale(1.05)`;
        });

        polaroidContainer.addEventListener('mouseleave', () => {
            polaroid.style.transform = `rotateX(0) rotateY(0) scale(1) rotate(2deg)`; // Reset to slight tilt
        });

        // --- 4. Grand Finale ---
        function celebrate() {
            const btn = document.getElementById('celebrate-btn');
            const finalMsg = document.getElementById('final-message');

            // 1. Disable and fade out button
            btn.disabled = true;
            gsap.to(btn, { opacity: 0, scale: 0.8, duration: 0.5, ease: "power2.in" });

            // 2. Reveal Final Text
            finalMsg.classList.remove('hidden');
            gsap.to(finalMsg, { 
                opacity: 1, 
                y: 0, 
                duration: 1, 
                delay: 0.5, 
                ease: "elastic.out(1, 0.5)" 
            });

            // 3. Trigger 3D Hearts Finale
            finaleMode = true;

            // 4. Confetti Explosion
            launchConfetti();
        }

        function launchConfetti() {
            // Burst 1: Bottom Corners
            const duration = 5 * 1000;
            const animationEnd = Date.now() + duration;
            const defaults = { startVelocity: 30, spread: 360, ticks: 60, zIndex: 100 };

            function randomInRange(min, max) {
                return Math.random() * (max - min) + min;
            }

            // Heavy Burst immediately
            confetti({
                particleCount: 100,
                spread: 70,
                origin: { y: 0.6 },
                colors: ['#ec4899', '#ef4444', '#f472b6']
            });

            // Continuous Shower
            const interval = setInterval(function() {
                const timeLeft = animationEnd - Date.now();

                if (timeLeft <= 0) {
                    return clearInterval(interval);
                }

                const particleCount = 50 * (timeLeft / duration);

                // Standard confetti
                confetti(Object.assign({}, defaults, { 
                    particleCount, 
                    origin: { x: randomInRange(0.1, 0.3), y: Math.random() - 0.2 } 
                }));
                confetti(Object.assign({}, defaults, { 
                    particleCount, 
                    origin: { x: randomInRange(0.7, 0.9), y: Math.random() - 0.2 } 
                }));
            }, 250);

            // Emoji Confetti
            setTimeout(() => {
                const scalar = 2;
                const emojiShape = confetti.shapeFromText({ text: '‚ù§Ô∏è', scalar });
                const starShape = confetti.shapeFromText({ text: '‚ú®', scalar });
                
                confetti({
                    shapes: [emojiShape, starShape],
                    scalar,
                    particleCount: 30,
                    spread: 100,
                    origin: { y: 0.4 },
                });
            }, 500);
        }

    </script>
</body>

</html>
